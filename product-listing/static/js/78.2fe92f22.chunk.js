"use strict";(self.webpackChunkmy_ecommerce=self.webpackChunkmy_ecommerce||[]).push([[78],{78:(e,r,t)=>{t.r(r),t.d(r,{default:()=>N});var l=t(43);const o={shared:{header:"flex justify-between items-center w-full mb-6",title:"font-semibold text-xl text-neutral-900"},productListing:{container:"flex-1 px-4 md:px-8 lg:px-8 xl:px-8 w-full max-w-[1280px] mx-auto box-border",header:"flex justify-between items-center mb-6 w-full",title:"text-lg font-semibold text-neutral-900",grid:"grid gap-6 sm:gap-8 md:gap-10 lg:gap-12 grid-cols-2 sm:grid-cols-3 xl:grid-cols-4 w-full",sortSelect:"border rounded px-3 py-2 text-sm bg-gray-50 hover:bg-gray-100 cursor-pointer"},productCard:{card:"flex flex-col w-full rounded-lg overflow-hidden shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-200 bg-white",image:"w-full h-[300px] object-cover rounded-t-lg bg-gray-100 transition-opacity duration-300",skeleton:"absolute top-0 left-0 w-full h-[300px] bg-gray-200 animate-pulse rounded-lg",details:"flex flex-col gap-3 p-4",color:"font-normal text-xs text-neutral-600",name:"font-medium text-lg text-neutral-900 truncate",price:"font-normal text-lg text-neutral-500",discount:"font-normal text-xs line-through text-neutral-600",colorOptions:"flex justify-start items-center gap-2 p-1 rounded",hoverShadow:"shadow-lg",outOfStockOverlay:"absolute top-0 left-0 w-full h-full bg-gray-400 opacity-50 flex justify-center items-center text-white font-bold",noImage:"w-full h-[300px] bg-gray-200 flex items-center justify-center text-gray-500 rounded-lg",priceDiscount:"text-red-500 ml-2 px-2",colorButton:"w-6 h-6 rounded-full cursor-pointer",colorButtonOutOfStock:"opacity-50 cursor-not-allowed",colorButtonSelected:"border-2 border-black"},colors:{primary:"#1E40AF",secondary:"#9333EA",neutral:{100:"#F5F5F5",200:"#E5E5E5",500:"#888888",900:"#333333"},success:"#28A745",error:"#DC3545"},spacing:{sm:"8px",md:"16px",lg:"32px",xl:"64px"},fontSize:{base:"16px",lg:"20px",xl:"24px"},borderRadius:{none:"0px",sm:"4px",md:"8px",lg:"16px"},extend:{screens:{xs:"480px",sm:"640px",md:"768px",lg:"1025px",xl:"1440px"}},layout:{container:"box-border w-full px-4 grid grid-cols-4 gap-4 md:px-8 md:grid-cols-6 md:gap-8 xl:max-w-[1280px] xl:mx-auto xl:px-8 xl:grid-cols-12 xl:gap-8",filterSection:"xl:col-span-3 md:hidden xl:block border-r border-neutral-200",productSection:"col-span-4 md:col-span-6 xl:col-span-9 flex flex-col"},productGrid:{container:"\n    grid \n    gap-4 md:gap-8 \n    grid-cols-2 sm:grid-cols-3 lg:grid-cols-4\n    w-full transition-all duration-300 ease-in-out\n  ",card:"bg-white rounded-lg overflow-hidden shadow-sm border border-neutral-200 hover:shadow-md transition-all duration-200",imageWrapper:"w-full aspect-square overflow-hidden bg-neutral-100",image:"w-full h-full object-cover",details:"p-3 flex flex-col gap-1",colorDot:"w-3 h-3 rounded-full inline-block border",title:"text-sm font-medium text-gray-800 truncate",price:"text-sm text-gray-600"},filterSidebar:{container:"w-64 p-4 border-r border-neutral-200 h-screen sticky top-0 bg-transparent",open:"transition-transform duration-300 ease-in-out translate-x-0",close:"transition-transform duration-300 ease-in-out -translate-x-full lg:translate-x-0",header:"text-lg font-semibold mb-4 flex justify-between items-center text-neutral-900",sectionButton:"flex justify-between w-full text-left font-medium py-2",sectionContent:"pl-4",clearButton:"mt-4 text-sm text-red-500 underline hover:text-red-600 transition-colors",closeButton:"p-1 rounded-md hover:bg-gray-100",filterButton:"fixed top-4 left-4 z-50 flex items-center gap-2 bg-white border border-gray-300 rounded-md px-3 py-2 shadow-sm text-gray-800 font-medium hover:bg-gray-50 md:hidden"}},s=[5,4,3,2,1],a="collection",n="category",i="sizes",c="colors",d=[{collection_id:"latest",name:"Latest Arrivals"},{collection_id:"cozy",name:"Cozy Comfort"},{collection_id:"urban",name:"Urban Oasis"},{collection_id:"fresh",name:"Fresh Fusion"}],u=()=>{const[e,r]=(0,l.useState)([]),[t,o]=(0,l.useState)(!0),[s,a]=(0,l.useState)(null);return(0,l.useEffect)((()=>{let e=!0;return fetch("https://www.greatfrontend.com/api/projects/challenges/e-commerce/products").then((e=>{if(!e.ok)throw new Error("Failed to fetch collections");return e.json()})).then((t=>{if(e&&null!==t&&void 0!==t&&t.data){const e=Array.from(new Map(t.data.filter((e=>e.collection)).map((e=>[e.collection.collection_id,e.collection.name])))).map((e=>{let[r,t]=e;return{collection_id:r,name:t}})),l=[...d,...e],o=Array.from(new Map(l.map((e=>[e.collection_id,e]))).values());r(o)}})).catch((r=>{e&&a(r.message)})).finally((()=>{e&&o(!1)})),()=>{e=!1}}),[]),{collections:e,loading:t,error:s}},p=()=>{const[e,r]=(0,l.useState)([]),[t,o]=(0,l.useState)(!0),[s,a]=(0,l.useState)(null);return(0,l.useEffect)((()=>{const e=new AbortController;return(async()=>{try{o(!0),a(null);let t=1;const l=9;let s=[];for(;;){const r=await fetch(`https://www.greatfrontend.com/api/projects/challenges/e-commerce/products?page=${t}&per_page=${l}`,{signal:e.signal});if(!r.ok)throw new Error("Failed to fetch products");const o=await r.json(),a=Array.isArray(null===o||void 0===o?void 0:o.data)?o.data:[];s=s.concat(a);const n=o.pagination;if(!n||!n.has_more)break;t+=1}r(s)}catch(t){"AbortError"!==t.name&&a(t.message||String(t))}finally{o(!1)}})(),()=>e.abort()}),[]),{products:e,loading:t,error:s}};var m=t(204),x=t(579);const g=[{id:"unisex",label:"Unisex"},{id:"women",label:"Women"},{id:"men",label:"Men"}],h=[{code:"xs",label:"XS"},{code:"s",label:"S"},{code:"m",label:"M"},{code:"l",label:"L"},{code:"xl",label:"XL"}],b=["white","black","red","orange","yellow","green","blue","brown","beige","pink"],f=e=>{let{filters:r,setFilters:t,isSidebarOpen:d,setIsSidebarOpen:u,collections:p=[],categories:f=[],sizes:v=[],colors:j=[]}=e;const[y,w]=(0,l.useState)({collection:!1,sizes:!1,category:!1,colors:!1,ratings:!1}),N=f&&f.length?f:g,C=v&&v.length?v:h,k=j&&j.length?j:b,S=e=>w((r=>({...r,[e]:!r[e]}))),$=(e,r)=>{t((t=>{let l=[...t[e]];return l.includes(r)?l=l.filter((e=>e!==r)):l.push(r),e===a&&0===l.length&&(l=["latest"]),{...t,[e]:l}}))};return(0,x.jsxs)("aside",{className:`${o.filterSidebar.container} ${d?"block":"hidden"} md:block z-40`,children:[(0,x.jsx)("div",{className:o.filterSidebar.header,children:(0,x.jsx)("button",{className:o.filterSidebar.closeButton,onClick:()=>u(!1)})}),(0,x.jsxs)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[(0,x.jsxs)("button",{onClick:()=>S("collection"),className:o.filterSidebar.sectionButton,children:[(0,x.jsx)("span",{children:"Collections"}),(0,x.jsx)("span",{children:y.collection?"\u2212":"+"})]}),y.collection&&(0,x.jsx)("div",{className:o.filterSidebar.sectionContent,children:null===p||void 0===p?void 0:p.map(((e,t)=>{var l,o;let{name:s,collection_id:n}=e;return(0,x.jsxs)("label",{className:"flex items-center space-x-2 py-1 cursor-pointer",children:[(0,x.jsx)("input",{type:"checkbox",checked:null!==(l=null===(o=r[a])||void 0===o?void 0:o.includes(n))&&void 0!==l&&l,onChange:()=>$(a,n)}),(0,x.jsx)("span",{children:s})]},`${n}-${t}`)}))})]}),(0,x.jsxs)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[(0,x.jsxs)("button",{onClick:()=>S("sizes"),className:o.filterSidebar.sectionButton,children:[(0,x.jsx)("span",{children:"Sizes"}),(0,x.jsx)("span",{children:y.sizes?"\u2212":"+"})]}),y.sizes&&(0,x.jsx)("div",{className:o.filterSidebar.sectionContent,children:C.map((e=>{var t;let{code:l,label:o}=e;return(0,x.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,x.jsx)("input",{type:"checkbox",checked:null!==(t=r[i].includes(l))&&void 0!==t&&t,onChange:()=>$("sizes",l)}),(0,x.jsx)("span",{children:o})]},l)}))})]}),(0,x.jsxs)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[(0,x.jsxs)("button",{onClick:()=>S("category"),className:o.filterSidebar.sectionButton,children:[(0,x.jsx)("span",{children:"Category"}),(0,x.jsx)("span",{children:y.category?"\u2212":"+"})]}),y.category&&(0,x.jsx)("div",{className:o.filterSidebar.sectionContent,children:N.map((e=>{let{id:t,label:l}=e;return(0,x.jsxs)("label",{className:"flex items-center space-x-2 py-1",children:[(0,x.jsx)("input",{type:"checkbox",checked:r[n].includes(t),onChange:()=>$("category",t)}),(0,x.jsx)("span",{children:l})]},t)}))})]}),(0,x.jsxs)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[(0,x.jsxs)("button",{onClick:()=>S("colors"),className:o.filterSidebar.sectionButton,children:[(0,x.jsx)("span",{children:"Colors"}),(0,x.jsx)("span",{children:y.colors?"\u2212":"+"})]}),y.colors&&(0,x.jsx)("div",{className:"flex flex-wrap gap-3 mt-2",children:k.map((e=>(0,x.jsx)("button",{onClick:()=>$("colors",e),className:"w-6 h-6 rounded-full border "+(r[c].includes(e)?"border-black scale-110":"border-gray-300"),style:{backgroundColor:e},title:e},e)))})]}),(0,x.jsxs)("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[(0,x.jsxs)("button",{onClick:()=>S("ratings"),className:o.filterSidebar.sectionButton,children:[(0,x.jsx)("span",{children:"Ratings"}),(0,x.jsx)("span",{children:y.ratings?"\u2212":"+"})]}),y.ratings&&(0,x.jsx)("div",{className:o.filterSidebar.sectionContent,children:s.map((e=>(0,x.jsxs)("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[(0,x.jsx)("input",{type:"checkbox",checked:r.ratings.includes(e),onChange:()=>$("ratings",e)}),(0,x.jsxs)("span",{className:"flex items-center",children:[Array.from({length:e}).map(((e,r)=>(0,x.jsx)(m.gt3,{className:"text-yellow-500"},r))),Array.from({length:5-e}).map(((e,r)=>(0,x.jsx)(m.gt3,{className:"text-gray-300"},`o-${r}`)))]})]},e)))})]}),(()=>{const e=Object.entries(r).reduce(((e,r)=>{let[t,l]=r;return Array.isArray(l)?e+l.length:"sort"===t&&"string"===typeof l&&l?e+1:e}),0);return e>0?(0,x.jsxs)("button",{onClick:()=>t({collection:[],category:[],sizes:[],colors:[],ratings:[],sort:"",direction:"desc"}),className:o.filterSidebar.clearButton,children:["Clear All (",e,")"]}):null})()]})};var v=t(315);const j=function(e){var r,t;let{product:s}=e;const a=(0,v.Zp)(),[n,i]=(0,l.useState)(s.colors[0]),[c,d]=(0,l.useState)(!1),[u,p]=(0,l.useState)(!0),m=s.images.filter((e=>e.color===n)),g=s.inventory.find((e=>e.color===n||{})),h=()=>g.discount_percentage?g.sale_price:g.list_price,b=e=>{var r;return!(null!==(r=s.inventory)&&void 0!==r&&r.find((r=>r.color===e&&r.stock-r.sold>0)))};return(0,l.useEffect)((()=>{s.images.forEach((e=>{const r=new Image;r.src=e.image_url,r.loading="eager",r.onload=()=>p(!1)}))}),[s.images]),(0,x.jsxs)("div",{className:`${o.productCard.card} ${c?o.productCard.hoverShadow:""}`,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),children:[(0,x.jsxs)("div",{className:"relative",children:[u&&(0,x.jsx)("div",{className:`${o.productCard.skeleton}`}),m.length>0?(0,x.jsx)("img",{src:null===(t=m[0])||void 0===t?void 0:t.image_url,alt:`${s.name} - ${n}`,className:`${o.productCard.image} ${u?"opacity-0":"opacity-100"}`,loading:"lazy",onLoad:()=>p(!1)},null===(r=m[0])||void 0===r?void 0:r.image_url):(0,x.jsx)("div",{className:`${o.productCard.noImage}`,children:"No Image Available"}),b(n)&&(0,x.jsx)("div",{className:`${o.productCard.outOfStockOverlay}`,"aria-label":"Out of stock",children:"Out of Stock"})]}),(0,x.jsxs)("div",{className:`${o.productCard.details}`,onClick:()=>a(`/product/${s.product_id}`),tabIndex:0,"aria-label":`View details for ${s.name}`,children:[(0,x.jsx)("div",{className:`${o.productCard.color}`,children:n}),(0,x.jsx)("h3",{className:`${o.productCard.name}`,children:s.name}),(0,x.jsx)("div",{className:"flex items-center",children:g.discount_percentage?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("span",{className:`${o.productCard.price} line-through px-2`,"aria-label":`Original price ${g.list_price} dollars`,children:["$",g.list_price]}),(0,x.jsxs)("span",{className:`${o.productCard.price} ${o.productCard.priceDiscount}`,"aria-label":`Discounted price ${h()} dollars`,children:["$",h()]})]}):(0,x.jsxs)("span",{className:`${o.productCard.price} px-2`,"aria-label":`Price ${g.list_price} dollars`,children:["$",g.list_price]})}),(0,x.jsx)("div",{className:`${o.productCard.colorOptions}`,children:s.colors.map(((e,r)=>(0,x.jsx)("button",{style:{backgroundColor:e},onClick:r=>((e,r)=>{e.stopPropagation(),i(r)})(r,e),role:"checkbox","aria-checked":e===n,className:`${o.productCard.colorButton} ${b(e)?o.productCard.colorButtonOutOfStock:""} ${e===n?o.productCard.colorButtonSelected:""}\n              }`},e||r)))})]})]})};var y=t(262);const w=e=>{let{products:r,className:t="",isLoading:l}=e;return(0,x.jsx)("div",{className:`${o.productGrid.container} ${t}`,children:l?Array.from({length:12}).map(((e,r)=>(0,x.jsxs)("div",{className:o.productGrid.card,children:[(0,x.jsx)("div",{className:o.productGrid.imageWrapper,children:(0,x.jsx)(y.A,{variant:"rectangular",width:"100%",height:"100%",sx:{borderRadius:"8px"}})}),(0,x.jsxs)("div",{className:o.productGrid.details,children:[(0,x.jsx)(y.A,{width:"80%",height:20}),(0,x.jsx)(y.A,{width:"60%",height:20})]})]},r))):r.map(((e,r)=>(0,x.jsx)(j,{product:e},`${e.product_id}-${r}`)))})},N=()=>{const[e,r]=(0,l.useState)({collection:[],category:[],sizes:[],colors:[],ratings:[],sort:"",direction:"desc"}),{collections:t}=u(),{products:s,loading:a,error:n}=p(),[i,c]=(0,l.useState)(!1),[d,g]=(0,l.useState)(1);(0,l.useEffect)((()=>{const e=window.matchMedia("(min-width: 1024px)"),r=e=>{e.matches||c(!1)};return e.addEventListener("change",r),()=>e.removeEventListener("change",r)}),[]),(0,l.useEffect)((()=>{g(1)}),[e]);const h=(0,l.useMemo)((()=>{const e=new Map;return s.forEach((r=>{const t=r.category;null!==t&&void 0!==t&&t.category_id&&(e.has(t.category_id)||e.set(t.category_id,{id:t.category_id,label:t.name}))})),Array.from(e.values())}),[s]),b=(0,l.useMemo)((()=>{const e=new Set;return s.forEach((r=>{(r.sizes||[]).forEach((r=>e.add(String(r).toLowerCase()))),(r.inventory||[]).map((e=>e.size)).filter((e=>null!=e)).forEach((r=>e.add(String(r).toLowerCase())))})),Array.from(e).map((e=>({code:e,label:e.toUpperCase()})))}),[s]),v=(0,l.useMemo)((()=>{const e=new Set;return s.forEach((r=>{(r.colors||[]).forEach((r=>e.add(r)))})),Array.from(e)}),[s]),j=(0,l.useMemo)((()=>{if(!s||0===s.length)return[];const r=(e.collection||[]).filter((e=>"latest"!==e));return[...s].filter((t=>{var l,o,s,a,n,i,c,d;const u=null!==(l=null===(o=t.collection)||void 0===o?void 0:o.collection_id)&&void 0!==l?l:null,p=0===r.length||r.includes(u),m=[...null!==(s=null===(a=t.sizes)||void 0===a?void 0:a.map((e=>String(e).toLowerCase())))&&void 0!==s?s:[],...null!==(n=null===(i=t.inventory)||void 0===i?void 0:i.map((e=>e.size)).filter(Boolean).map((e=>String(e).toLowerCase())))&&void 0!==n?n:[]],x=0===e.sizes.length||m.some((r=>e.sizes.includes(r))),g=null!==(c=t.colors)&&void 0!==c?c:[],h=0===e.colors.length||g.some((r=>e.colors.includes(r))),b=0===e.ratings.length||e.ratings.some((e=>t.rating>=e&&t.rating<e+1)),f=0===e.category.length||e.category.includes(null===(d=t.category)||void 0===d?void 0:d.category_id);return p&&x&&h&&b&&f})).sort(((r,t)=>{var l,o,s,a,n,i,c,d,u,p,m,x;const g=e.sort||"created",h=e.direction||"desc";let b,f;switch(g){case"popular":b=null!==(l=r.sold)&&void 0!==l?l:0,f=null!==(o=t.sold)&&void 0!==o?o:0;break;case"rating":b=null!==(s=r.rating)&&void 0!==s?s:0,f=null!==(a=t.rating)&&void 0!==a?a:0;break;case"price":b="asc"===h?null!==(n=null===(i=r.priceRange)||void 0===i?void 0:i.lowest)&&void 0!==n?n:0:null!==(c=null===(d=r.priceRange)||void 0===d?void 0:d.highest)&&void 0!==c?c:0,f="asc"===h?null!==(u=null===(p=t.priceRange)||void 0===p?void 0:p.lowest)&&void 0!==u?u:0:null!==(m=null===(x=t.priceRange)||void 0===x?void 0:x.highest)&&void 0!==m?m:0;break;default:b=new Date(r.created_at).getTime(),f=new Date(t.created_at).getTime()}return"asc"===h?b-f:f-b}))}),[s,e]),y=Math.max(1,Math.ceil(j.length/9)),N=(0,l.useMemo)((()=>{const e=9*(d-1);return j.slice(e,e+9)}),[j,d]),C=n?(0,x.jsx)("p",{className:"text-red-500 mt-4",children:n}):null;return(0,x.jsxs)("div",{className:"flex relative",children:[(0,x.jsxs)("button",{className:`${o.filterSidebar.filterButton} md:hidden ${i?"hidden":""}`,onClick:()=>c(!0),children:[(0,x.jsx)(m.YsJ,{size:16}),(0,x.jsx)("span",{children:"Filter"})]}),(0,x.jsx)(f,{filters:e,setFilters:r,isSidebarOpen:i,setIsSidebarOpen:c,collections:t,categories:h,sizes:b,colors:v}),i&&(0,x.jsx)("div",{className:"fixed inset-0 md:hidden z-30 bg-transparent",onClick:()=>c(!1)}),(0,x.jsxs)("div",{className:o.productListing.container,children:[(0,x.jsxs)("div",{className:`${o.shared.header} ${o.productListing.header}`,children:[(0,x.jsx)("span",{}),(0,x.jsxs)("select",{value:"price"===e.sort?"asc"===e.direction?"price-asc":"price-desc":e.sort,onChange:e=>{switch(e.target.value){case"price-asc":r((e=>({...e,sort:"price",direction:"asc"})));break;case"price-desc":r((e=>({...e,sort:"price",direction:"desc"})));break;case"popular":r((e=>({...e,sort:"popular",direction:"desc"})));break;case"rating":r((e=>({...e,sort:"rating",direction:"desc"})));break;default:r((e=>({...e,sort:"created",direction:"desc"})))}},className:o.productListing.sortSelect,"aria-label":"Sort products",children:[(0,x.jsx)("option",{value:"",disabled:!0,children:"Sort By"}),(0,x.jsx)("option",{value:"created",children:"Newest"}),(0,x.jsx)("option",{value:"popular",children:"Most popular"}),(0,x.jsx)("option",{value:"rating",children:"Best rating"}),(0,x.jsx)("option",{value:"price-asc",children:"Price: Low to high"}),(0,x.jsx)("option",{value:"price-desc",children:"Price: High to low"})]})]}),C,(0,x.jsx)(w,{products:N,className:`${o.productGrid.container} ${i?"lg:ml-64":"ml-0"}`,isLoading:a}),j.length>0&&(0,x.jsxs)("div",{className:"flex justify-center items-center mt-8 gap-4",children:[(0,x.jsx)("button",{disabled:1===d,onClick:()=>g((e=>Math.max(1,e-1))),className:"px-4 py-2 border rounded disabled:opacity-50",children:"Prev"}),(0,x.jsxs)("span",{children:["Page ",d," of ",y]}),(0,x.jsx)("button",{disabled:d===y,onClick:()=>g((e=>Math.min(y,e+1))),className:"px-4 py-2 border rounded disabled:opacity-50",children:"Next"})]})]})]})}}}]);
//# sourceMappingURL=78.2fe92f22.chunk.js.map